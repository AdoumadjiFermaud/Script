from sklearn.datasets import fetch_mldata
from sklearn.ensemble import RandomForestClassifier
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score
import numpy as np

# fetch data from MNIST
mnist = fetch_mldata("MNIST original", data_home="./data")
data = np.array(mnist.data)

features_train, features_test, labels_train, labels_test = train_test_split(data, mnist.target)
cls = RandomForestClassifier()
cls.fit(features_train, labels_train)
pred = cls.predict(features_test)
score = accuracy_score(pred, labels_test)
print(score)
